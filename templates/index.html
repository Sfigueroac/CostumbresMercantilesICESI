{% extends 'base.html' %}

{% block body %}
<h1>P√°gina de Costumbres Mercantiles de Colombia</h1>

<section class="search-section">
    <h2>Buscar Costumbres</h2>
    <form method="GET" action="/" class="search-form">
        <div class="input-group">
            <input type="text" name="search_ciudad" placeholder="üèôÔ∏è Buscar por ciudad (ej: Bogot√°, Medell√≠n)" 
                   value="{{ request.args.get('search_ciudad', '') }}" autocomplete="off">
        </div>
        <div class="input-group">
            <input type="text" name="search_tipo" placeholder="üìã Buscar por tipo (ej: Comercial, Bancario)" 
                   value="{{ request.args.get('search_tipo', '') }}" autocomplete="off">
        </div>
        <div class="input-group">
            <input type="text" name="search_contenido" placeholder="üîç Buscar por contenido o palabras clave" 
                   value="{{ request.args.get('search_contenido', '') }}" autocomplete="off">
        </div>
        <div class="button-group">
            <button type="submit" class="search-button">
                <span class="sr-only">Realizar b√∫squeda</span>
                üîç Buscar
            </button>
            {% if request.args.get('search_ciudad') or request.args.get('search_tipo') or request.args.get('search_contenido') %}
            <a href="/" class="clear-button">
                üóëÔ∏è Limpiar
            </a>
            {% endif %}
        </div>
    </form>
</section>

<section class="results-section">
    <h2>
        {% if request.args.get('search_ciudad') or request.args.get('search_tipo') or request.args.get('search_contenido') %}
            Resultados de la B√∫squeda
            {% if lascostumbres %}
                <small>({{ lascostumbres|length }} encontradas)</small>
            {% endif %}
        {% else %}
            Todas las Costumbres Mercantiles
            {% if lascostumbres %}
                <small>({{ lascostumbres|length }} registros)</small>
            {% endif %}
        {% endif %}
    </h2>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Ciudad</th>
                    <th>Tipo de Costumbre</th>
                    <th>Contenido</th>
                </tr>
            </thead>
            <tbody>
                {% if lascostumbres %}
                    {% for costumbre in lascostumbres %}
                        <tr>
                            <td class="city-cell">{{ costumbre.ciudad }}</td>
                            <td class="type-cell">{{ costumbre.tipo }}</td>
                            <td class="content-cell">{{ costumbre.contenido }}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="3" class="empty-state">
                            {% if request.args.get('search_ciudad') or request.args.get('search_tipo') or request.args.get('search_contenido') %}
                                No se encontraron costumbres mercantiles que coincidan con los criterios de b√∫squeda.
                                <br><small>Intenta con t√©rminos m√°s generales o <a href="/">ver todas las costumbres</a>.</small>
                            {% else %}
                                No hay costumbres mercantiles disponibles en este momento.
                                <br><small>Base de datos con 176 costumbres mercantiles reales de Colombia.</small>
                            {% endif %}
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    
    {% if lascostumbres and lascostumbres|length > 20 %}
    <div class="scroll-hint">
        üí° <small>Desliza horizontalmente para ver todo el contenido en dispositivos m√≥viles</small>
    </div>
    {% endif %}
</section>

{% endblock %}
